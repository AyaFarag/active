(function($){"use strict";$.fn.photoslider=function(options){var settings=$.extend({autoplay:true,duration:3e3,speed:400,resize:true,prefix:"photoslider",navigation:true,navigationPrev:true,navigationNext:true,prevText:"PREV",nextText:"NEXT"},options);var cssClassWrapper=settings.prefix+"__wrapper";var cssClassItem=settings.prefix+"__item";var cssClassMask=settings.prefix+"__mask";var cssClassNav=settings.prefix+"__nav";var cssClassNavPrev=settings.prefix+"__prev";var cssClassNavNext=settings.prefix+"__next";var cssClassAnimation=settings.prefix+"--animation";var markupWrapper='<div class="'+cssClassWrapper+'"></div>';var markupMask='<div class="'+cssClassMask+'"></div>';var markupNavigation='<div class="'+cssClassNav+'"></div>';var markupNavigationPrev='<div class="'+cssClassNavPrev+'">'+settings.prevText+"</div>";var markupNavigationNext='<div class="'+cssClassNavNext+'">'+settings.nextText+"</div>";function _setup($target){$target.find("."+cssClassItem).wrapAll(markupWrapper);var $wrapper=$target.find("."+cssClassWrapper);$wrapper.find("."+cssClassItem+":first-child").addClass("first-item");$wrapper.find("."+cssClassItem+":last-child").addClass("last-item");$wrapper.wrap(markupMask);var $items=$wrapper.find("."+cssClassItem);$wrapper.prepend($items.clone().addClass("cloned").removeClass("first-item last-item"));$wrapper.append($items.clone().addClass("cloned").removeClass("first-item last-item"));$wrapper.attr("data-pos",0);$wrapper.find("."+cssClassItem+".first-item").addClass("current-item");_resize($target);_currentSlide($target);_autoPlayStart($target,settings.duration);_setupNavigation($target)}function _setupNavigation($target){if(!settings.navigation){return false}$target.append(markupNavigation);_setupNavigationPrev($target);_setupNavigationNext($target);return true}function _setupNavigationPrev($target){if(!settings.navigationPrev){return false}$target.find("."+cssClassNav).append(markupNavigationPrev);$target.find("."+cssClassNavPrev).click(function(){_moveSlide($target,"prev")});return true}function _setupNavigationNext($target){if(!settings.navigationNext){return false}$target.find("."+cssClassNav).append(markupNavigationNext);$target.find("."+cssClassNavNext).click(function(){_moveSlide($target,"next")});return true}function _currentSlide($target){var $wrapper=$target.find("."+cssClassWrapper);$wrapper.removeClass(cssClassAnimation);setTimeout(function(){var pos=$target.find("."+cssClassItem+".current-item").position().left*-1;var $wrapper=$target.find("."+cssClassWrapper);$wrapper.css("transform","translateX("+pos+"px)");$wrapper.attr("data-pos",pos)},100);setTimeout(function(){$wrapper.addClass(cssClassAnimation)},250)}function _moveSlide($target,direction){var $wrapper=$target.find("."+cssClassWrapper);var curPos=parseFloat($wrapper.attr("data-pos"));var $currentItem=$wrapper.find(".current-item").removeClass("current-item");var $nextItem="";if(direction==="prev"){$nextItem=$currentItem.prev()}if(direction==="next"){$nextItem=$currentItem.next()}var nextPos=$nextItem.addClass("current-item").position().left*-1+curPos;$wrapper.css("transform","translateX("+nextPos+"px)");$wrapper.attr("data-pos",nextPos);if($nextItem.hasClass("cloned")){_silentLoop($target,direction);return false}_autoPlayReset($target,settings.duration)}function _silentLoop($target,direction){var time=settings.duration;setTimeout(function(){var $wrapper=$target.find("."+cssClassWrapper);var curPos=parseFloat($wrapper.attr("data-pos"));var $nextItem="";$wrapper.find(".current-item").removeClass("current-item");if(direction==="prev"){$nextItem=$wrapper.find(".last-item")}if(direction==="next"){$nextItem=$wrapper.find(".first-item")}var nextPos=$nextItem.addClass("current-item").position().left*-1+curPos;$wrapper.removeClass(cssClassAnimation);setTimeout(function(){$wrapper.css("transform","translateX("+nextPos+"px)");$wrapper.attr("data-pos",nextPos)},100);setTimeout(function(){$wrapper.addClass(cssClassAnimation);_autoPlayReset($target,time-settings.speed-400)},200)},settings.speed+100)}function _autoPlayStart($target,time){if(!settings.autoplay){return false}$target.interval=window.setTimeout(function(){_moveSlide($target,"next")},time);return true}function _autoPlayReset($target,time){if(!settings.autoplay){return false}window.clearTimeout($target.interval);_autoPlayStart($target,time);return true}function _resize($target){if(!settings.resize){return false}var $items=$target.find("."+cssClassItem);var photosliderHeight=$target.height();$items.each(function(){var width=$(this).attr("data-width");var height=$(this).attr("data-height");var ratio=height/width;$(this).height(photosliderHeight);$(this).width(photosliderHeight/ratio)});return true}return this.each(function(){var $target=$(this);_setup($target);$(window).resize(function(){_resize($target)});var hidden,visibilityChange;if(typeof document.hidden!=="undefined"){hidden="hidden";visibilityChange="visibilitychange"}else if(typeof document.msHidden!=="undefined"){hidden="msHidden";visibilityChange="msvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){hidden="webkitHidden";visibilityChange="webkitvisibilitychange"}if(typeof document.addEventListener!="undefined"||typeof document[hidden]!="undefined"){document.addEventListener(visibilityChange,function(){if(document[hidden]){window.clearTimeout($target.interval)}else{_autoPlayStart($target,settings.duration)}},false)}})}})(jQuery);